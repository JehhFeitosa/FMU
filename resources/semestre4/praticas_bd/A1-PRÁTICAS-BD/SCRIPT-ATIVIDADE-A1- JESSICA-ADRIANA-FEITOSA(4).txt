USE FMU;

CREATE PROCEDURE ATIVIDADE_A1
AS
DECLARE @INICIO INT = 1, @FINAL INT = 3000, @FIM INT = 30000, @QTD_HOMENS INT, @QTD_MULHERES INT;


WHILE(@INICIO <= @FIM)
	BEGIN
		IF NOT EXISTS(SELECT * FROM SYSOBJECTS WHERE NAME = 'RELACAO')
			BEGIN
				-- CRIE UMA NOVA TABELA CHAMADA RELACAO
				CREATE TABLE RELACAO(
					ID INT IDENTITY(1,1) NOT NULL,
					INICIO INT NULL,
					FINAL INT NULL,
					MULHERES INT NULL,
					HOMENS INT NULL,

					CONSTRAINT PK_RELACAO PRIMARY KEY(ID)
				)
			END
		ELSE 
			BEGIN
				SELECT @QTD_MULHERES = COUNT(*) FROM FUNCIONARIO WHERE SEXO = 'F' AND SALARIO >= @INICIO AND SALARIO <= @FINAL; 
				SELECT @QTD_HOMENS = COUNT(*) FROM FUNCIONARIO WHERE SEXO = 'M' AND SALARIO >= @INICIO AND SALARIO <= @FINAL; 

				-- INSERE OS DADOS ARMAZENADOS NAS VARIAVEIS DENTRO DE CADA POSICAO DA TABELA RELACAO
				INSERT INTO RELACAO(INICIO, FINAL, MULHERES, HOMENS) VALUES (@INICIO, @FINAL, @QTD_MULHERES, @QTD_HOMENS)

				SET @INICIO = @INICIO + 3000; -- INCREMENTA O VALOR DE INICIO
				SET @FINAL = @FINAL + 3000; -- INCREMENTA O VALOR DE FINAL
			END

	END


SELECT * FROM RELACAO;


EXECUTE ATIVIDADE_A1;